(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[153],{3334:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-role",function(){return s(8351)}])},6975:function(e,n){"use strict";n.Z={src:"/_next/static/media/load-balancer-role-1.c64d18c4.png",height:1258,width:2274,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAIAAAA8r+mnAAAATklEQVR42iWLWwrAMAgEvf9VCyU0vlZjrVCYr90Zup51q6gbHKLq7ueczKQlvERYxMwjYqburiravNXGVIMhMcwNgLaxhkZFduY7/MX7AR6zXTBYjDD5AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:4}},3703:function(e,n){"use strict";n.Z={src:"/_next/static/media/load-balancer-role-2.29b0ec08.png",height:904,width:2288,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAPklEQVR42iWGtw3AMAzA9P+jGaJmdW9xYIIgCEjIzF19PUxPZcLrhCG5W9Njl09Zh00BL0UVcVvplnH6Pz0fB9hEVK9CvlQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3}},2199:function(e,n){"use strict";n.Z={src:"/_next/static/media/load-balancer-role-3.5310843b.png",height:846,width:2290,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAO0lEQVR42jWI2w6AMAjF+P+PFV24HBFEs2VNH5rSwXyNoabubtMVxHLKLUjEG8vuripSNTMHEJv/PpkfKOxFwesfJugAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3}},8351:function(e,n,s){"use strict";s.r(n),s.d(n,{__toc:function(){return h}});var t=s(5893),a=s(2673),r=s(7913),o=s(8426);s(9128);var i=s(2643),c=s(6975),l=s(3703),d=s(2199);let h=[];function _createMdxContent(e){let n=Object.assign({h1:"h1",p:"p",strong:"strong",ul:"ul",li:"li",ol:"ol",a:"a",code:"code",img:"img",pre:"pre",span:"span"},(0,i.a)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{children:"Create IAM Role for the NAT Instance"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"NAT instance"})," will have to perform the following actions in its launch process:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Disable the ",(0,t.jsx)(n.strong,{children:"Source/destination check"}),", which is enabled by default for ",(0,t.jsx)(n.strong,{children:"EC2 instances"}),". If not, the ",(0,t.jsx)(n.strong,{children:"NAT instance"})," will drop the traffic that is not coming from or going to itself."]}),"\n",(0,t.jsxs)(n.li,{children:["Attach the ",(0,t.jsx)(n.strong,{children:"ENI"}),". The ",(0,t.jsx)(n.strong,{children:"NAT instance"})," will use this ",(0,t.jsx)(n.strong,{children:"ENI"})," to forward traffic from the private instances to the internet and vice versa."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Therefore, we need to create an ",(0,t.jsx)(n.strong,{children:"IAM role"})," and attach it to the ",(0,t.jsx)(n.strong,{children:"NAT instance"})," later. This ",(0,t.jsx)(n.strong,{children:"IAM role"})," allows the ",(0,t.jsx)(n.strong,{children:"NAT instance"})," to perform the actions mentioned above."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Open the ",(0,t.jsx)(n.a,{href:"https://console.aws.amazon.com/iam",children:"IAM console"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the sidebar, choose ",(0,t.jsx)(n.strong,{children:"Roles"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Choose ",(0,t.jsx)(n.strong,{children:"Create role"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Choose ",(0,t.jsx)(n.code,{children:"AWS service"})," as the ",(0,t.jsx)(n.strong,{children:"Trusted entity type"})," and select ",(0,t.jsx)(n.code,{children:"EC2"})," as the ",(0,t.jsx)(n.strong,{children:"Use case"}),". Choose ",(0,t.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Create role 1",placeholder:"blur",src:c.Z})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Add permissions"})," page, search for and select ",(0,t.jsx)(n.code,{children:"AmazonEC2FullAccess"}),". And then choose ",(0,t.jsx)(n.strong,{children:"Next"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Create role 2",placeholder:"blur",src:l.Z})}),"\n",(0,t.jsxs)(n.p,{children:["Note that the ",(0,t.jsx)(n.code,{children:"AmazonEC2FullAccess"})," policy is used here for demonstration purposes. In a production environment, you should create a custom policy with the minimum required permissions.\nFor example, you can create a custom policy with the following permissions:"]}),"\n",(0,t.jsx)(n.pre,{"data-language":"json","data-theme":"default",hasCopyCode:!0,children:(0,t.jsxs)(n.code,{"data-language":"json","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"Version"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"2012-10-17"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"Statement"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        {"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"Effect"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Allow"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"Action"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ec2:ModifyInstanceAttribute"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ec2:ModifyNetworkInterfaceAttribute"'})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            ]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'"Resource"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"*"'})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    ]"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Review"})," page, enter the ",(0,t.jsx)(n.strong,{children:"Role name"})," and choose ",(0,t.jsx)(n.strong,{children:"Create role"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Create role 3",placeholder:"blur",src:d.Z})}),"\n"]}),"\n"]})]})}let p={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.a)(),e.components);return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-role.mdx",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-role",timestamp:1723654418e3,pageMap:[{kind:"Meta",data:{index:"Introduction",overview:"Overview","before-you-start":"Before You Start",workshops:"Workshops",contact:{title:"Contact â†—",type:"page",href:"https://www.linkedin.com/in/nghia-pham-70a0ab205/",newWindow:!0}}},{kind:"MdxPage",name:"before-you-start",route:"/before-you-start"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"overview",route:"/overview"},{kind:"Folder",name:"workshops",route:"/workshops",children:[{kind:"Meta",data:{"eni-and-use-cases":"Elastic Network Interfaces (ENIs) and Use Cases"}},{kind:"Folder",name:"eni-and-use-cases",route:"/workshops/eni-and-use-cases",children:[{kind:"Meta",data:{"setup-a-low-budget-nat-instance":"Setup a Low-Budget NAT Instance","setup-a-low-budget-load-balancer":{display:"hidden",title:"Setup a Low Budget Load Balancer"}}},{kind:"MdxPage",name:"setup-a-low-budget-load-balancer",route:"/workshops/eni-and-use-cases/setup-a-low-budget-load-balancer"},{kind:"Folder",name:"setup-a-low-budget-nat-instance",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance",children:[{kind:"Meta",data:{"create-a-vpc":"1. Create a VPC","create-private-security-group":"2. Create the Security Group for the Private Instances","create-nat-security-group":"3. Create the Security Group for the NAT Instance","create-nat-role":"4. Create IAM Role for the NAT Instance","create-an-eni":"5. Create an ENI","update-private-route-tables":"6. Update Private Route Tables","create-nat-launch-template":"7. Create Launch Template for the NAT Instance","launch-nat-instance-with-asg":"8. Launch NAT Instance with Auto Scaling Group","test-nat-instance":"9. Test the NAT Instance","clean-up":"10. Clean Up",conclusion:"11. Conclusion"}},{kind:"MdxPage",name:"clean-up",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/clean-up"},{kind:"MdxPage",name:"conclusion",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/conclusion"},{kind:"MdxPage",name:"create-a-vpc",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-a-vpc"},{kind:"MdxPage",name:"create-an-eni",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-an-eni"},{kind:"MdxPage",name:"create-nat-launch-template",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-launch-template"},{kind:"MdxPage",name:"create-nat-role",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-role"},{kind:"MdxPage",name:"create-nat-security-group",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-security-group"},{kind:"MdxPage",name:"create-private-security-group",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-private-security-group"},{kind:"MdxPage",name:"launch-nat-instance-with-asg",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/launch-nat-instance-with-asg"},{kind:"MdxPage",name:"test-nat-instance",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/test-nat-instance"},{kind:"MdxPage",name:"update-private-route-tables",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/update-private-route-tables"}]},{kind:"MdxPage",name:"setup-a-low-budget-nat-instance",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance"}]},{kind:"MdxPage",name:"eni-and-use-cases",route:"/workshops/eni-and-use-cases"}]},{kind:"MdxPage",name:"workshops",route:"/workshops"}],flexsearch:{codeblocks:!0},title:"Create IAM Role for the NAT Instance",headings:h},pageNextRoute:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-role",nextraLayout:r.ZP,themeConfig:o.Z};n.default=(0,a.j)(p)},8426:function(e,n,s){"use strict";var t=s(5893);s(7294);var a=s(5675),r=s.n(a);let o={head:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,t.jsx)("meta",{property:"og:title",content:"Benlab"}),(0,t.jsx)("meta",{property:"og:description",content:"Let's learn together"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",href:"/images/logo.png"})]}),logo:(0,t.jsxs)("span",{children:[(0,t.jsx)(r(),{className:"rounded-full",src:"/images/logo.png",alt:"logo",height:50,width:50,style:{borderRadius:"50%",display:"inline-block"}})," ",(0,t.jsx)("b",{children:"BENLAB'S WORKSHOPS"})]}),project:{link:"https://github.com/phamtrongngh/aws-workshops"},docsRepositoryBase:"https://github.com/phamtrongngh/aws-workshops",footer:{text:""},editLink:{component:null},feedback:{content:"Give feedback"},useNextSeoProps:()=>({titleTemplate:"%s - Benlab's Workshops"})};n.Z=o},5789:function(){}},function(e){e.O(0,[774,543,888,179],function(){return e(e.s=3334)}),_N_E=e.O()}]);