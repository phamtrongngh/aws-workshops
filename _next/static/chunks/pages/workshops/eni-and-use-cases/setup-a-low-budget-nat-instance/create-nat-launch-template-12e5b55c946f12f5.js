(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[79],{7237:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-launch-template",function(){return n(2904)}])},2007:function(e,s){"use strict";s.Z={src:"/_next/static/media/launch-template-2.87fb4a22.png",height:1584,width:1626,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAd0lEQVR42jXN2woDIQwEUP//U/uw25h7Ym1nhR4GIpgwYzK/gQjBULU4hqq6uSGHB2RVjYy8jSR19eruz97fvddaI9xfQpdJZuKtYO6RA9c3k4TX0VUR4eiYQNP0X5DZ1bh+PkSEmf2IDGJ6yrGIkSeA2mteWfUDKdy5ABIjcyAAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},247:function(e,s){"use strict";s.Z={src:"/_next/static/media/launch-template-3.a676bee5.png",height:1074,width:1638,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAVElEQVR42hWFiQ3AIAzEsv+uLYE85A4qFWTLlmFm4QVgoQ4EyZwlr7fmqt4DyY9zzwLX2tJ9PF2bDcso1hE4K3EPMwNAErjHDUVDjRY78/jdggvkDzYUc7YhLGWpAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5}},4849:function(e,s){"use strict";s.Z={src:"/_next/static/media/launch-template-5.fcdbac0d.png",height:386,width:1612,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAAL0lEQVR42gWAwQ0AIQgEZ+Eu0f471S+wRueentlrh2QMCI39VTThigJnJib7D/kBKgkT9JaeycgAAAAASUVORK5CYII=",blurWidth:8,blurHeight:2}},2904:function(e,s,n){"use strict";n.r(s),n.d(s,{__toc:function(){return k},default:function(){return g}});var t=n(5893),r=n(2673),i=n(7913),a=n(8426);n(9128);var o=n(2643),l={src:"/_next/static/media/launch-template-6.fa41b26a.png",height:1208,width:1658,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAIAAABxZ0isAAAAXklEQVR42iWNUQ7DMAxCMbaVNfe/43qIJIy1T/5ADwnH977XWhKu65OZAAQEUHPOc05EVGZ3S3K2qSTdjzFI2ubDdiEBCPgiGH9gJNpk0vHs/e7gocKQ1Q1rwOvvjx8vHSxKwIz/cgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:6},c=n(2007),h=n(247),d={src:"/_next/static/media/launch-template-7.40f31722.png",height:980,width:1620,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAVklEQVR42k3KgQrDQAgD0Pv/T93G6iJ6nvFgllKoCIG8DFUFNNbKx0XEwAnwOZv6SSarcwjs+JnNc+Xumdx7V9X4qLwgEuaMq2pigxjeOL6GWeuGSvIPTgR0DBg3BqAAAAAASUVORK5CYII=",blurWidth:8,blurHeight:5},p={src:"/_next/static/media/launch-template-8.659aebe7.png",height:1622,width:1632,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAaVBMVEX9/f38/Pz7+/z7+/v6+/v6+vr5+vr5+fr1/PX5+fn2+/b4+fn4+Pj1+vT3+Pj39/f29/f29vb19vb19fb19fX09fX09PTz9PTz8/Py8/Xy8/Py8vLx8vPx8fHw8fHw8PHv8PHv8PDt7u4LQw/nAAAARElEQVR42gVABxZAMAz9VFSMdKtNe/9Dejg3mlSjBAyqgTqCm2lvl2HEGuTz+TJ4i63JOIZ3OiI+gpykWB8Zx60NcU8/gywD3xijz2cAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},x=n(4849);let k=[];function _createMdxContent(e){let s=Object.assign({h1:"h1",p:"p",strong:"strong",ol:"ol",li:"li",a:"a",img:"img",code:"code",pre:"pre",span:"span",blockquote:"blockquote"},(0,o.a)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{children:"Create Launch Template for the NAT Instance"}),"\n",(0,t.jsxs)(s.p,{children:["As mentioned earlier, the ",(0,t.jsx)(s.strong,{children:"NAT instance"})," will be set up in an ",(0,t.jsx)(s.strong,{children:"Auto-Scaling Group."}),"\nTherefore, we need to create a ",(0,t.jsx)(s.strong,{children:"launch template"})," for launching the ",(0,t.jsx)(s.strong,{children:"NAT instance"})," later."]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Open the ",(0,t.jsx)(s.a,{href:"https://console.aws.amazon.com/ec2/",children:"EC2 console"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["In the sidebar, choose ",(0,t.jsx)(s.strong,{children:"Instances > Launch Templates"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Choose ",(0,t.jsx)(s.strong,{children:"Create launch template"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.strong,{children:"Create launch template"})," wizard, enter ",(0,t.jsx)(s.strong,{children:"Launch template name"})," and tick the checkbox for ",(0,t.jsx)(s.strong,{children:"Auto Scaling guidance"}),"."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Launch template 1",placeholder:"blur",src:l})}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["In ",(0,t.jsx)(s.strong,{children:"Application and OS Images (Amazon Machine Image)"})," section, choose ",(0,t.jsx)(s.strong,{children:"Quick Start"})," and select the latest ",(0,t.jsx)(s.strong,{children:"Amazon Linux 2023 AMI"}),"."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Launch template 2",placeholder:"blur",src:c.Z})}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Choose ",(0,t.jsx)(s.code,{children:"t2.micro"})," as ",(0,t.jsx)(s.strong,{children:"Instance type"}),", which is eligible for the ",(0,t.jsx)(s.a,{href:"https://aws.amazon.com/free/",children:"AWS Free Tier"}),". You can choose a different instance type based on your system requirements."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Choose the ",(0,t.jsx)(s.strong,{children:"Key pair"})," for connecting to the ",(0,t.jsx)(s.strong,{children:"NAT instance"})," later. If you don't have a key pair, you can create one by choosing ",(0,t.jsx)(s.strong,{children:"Create new key pair"}),"."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Launch template 3",placeholder:"blur",src:h.Z})}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.strong,{children:"Network settings"}),", choose the ",(0,t.jsx)(s.strong,{children:"Security group"})," you created earlier for the ",(0,t.jsx)(s.strong,{children:"NAT instance"}),"."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Launch template 4",placeholder:"blur",src:d})}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["In ",(0,t.jsx)(s.strong,{children:"Advanced network configuration"}),", choose ",(0,t.jsx)(s.strong,{children:"Add network interface"})," and enable ",(0,t.jsx)(s.strong,{children:"Auto-assign public IP"}),"."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Launch template 9",placeholder:"blur",src:p})}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["In ",(0,t.jsx)(s.strong,{children:"Advanced details"})," section, choose the ",(0,t.jsx)(s.strong,{children:"IAM role"})," you created in the ",(0,t.jsx)(s.a,{href:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-role",children:"previous step"})," as the ",(0,t.jsx)(s.strong,{children:"IAM instance profile"}),".\n",(0,t.jsx)(s.img,{alt:"Launch template 5",placeholder:"blur",src:x.Z})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Copy"})," the following script and paste it in the ",(0,t.jsx)(s.strong,{children:"User data"})," section. This script will attach the ",(0,t.jsx)(s.strong,{children:"ENI"})," to the instance, disable source/destination check, install and configure ",(0,t.jsx)(s.strong,{children:"iptables"})," for ",(0,t.jsx)(s.strong,{children:"NAT"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,t.jsxs)(s.code,{"data-line-numbers":"","data-language":"bash","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"#!/bin/bash"})}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"yum"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"update"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-y"})]}),"\n",(0,t.jsx)(s.span,{className:"line",children:" "}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Get the instance ID"})}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"TOKEN"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"$("}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"curl"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-X"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"PUT"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"http://169.254.169.254/latest/api/token"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-H"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "X-aws-ec2-metadata-token-ttl-seconds: 21600")'})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"INSTANCE_ID"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"$("}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"curl"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"http://169.254.169.254/latest/meta-data/instance-id"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-H"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "X-aws-ec2-metadata-token: $TOKEN")'})]}),"\n",(0,t.jsx)(s.span,{className:"line",children:" "}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Attach the ENI to the instance"})}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ENI_ID"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"$("}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"aws"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ec2"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"describe-network-interfaces"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--filters"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "Name=tag:Name,'}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},className:"highlighted",children:"Values=nat-eni"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'" '}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--query"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'NetworkInterfaces[*].NetworkInterfaceId' "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--output"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"text"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:")"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"aws"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ec2"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"attach-network-interface"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--network-interface-id"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ${ENI_ID} "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--instance-id"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" $INSTANCE_ID "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--device-index"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]}),"\n",(0,t.jsx)(s.span,{className:"line",children:" "}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Disable source/destination check for two interfaces of the instance"})}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ENI_IDS"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"$("}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"aws"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ec2"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"describe-instances"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--instance-ids"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" $INSTANCE_ID "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--query"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "Reservations[*].Instances[*].NetworkInterfaces[*].NetworkInterfaceId" '}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--output"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"text"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:")"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ENI_ID "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" $ENI_IDS; "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"aws"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ec2"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"modify-network-interface-attribute"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--network-interface-id"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" $ENI_ID "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--no-source-dest-check"})]}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"done"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:" "}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Install iptables, enable IP forwarding, and configure iptables"})}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"yum"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"install"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"iptables-services"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-y"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"systemctl"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"enable"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"iptables"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"systemctl"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"start"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"iptables"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"echo"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"net.ipv4.ip_forward = 1"'}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"/etc/sysctl.d/custom-ip-forwarding.conf"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"sysctl"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-p"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"/etc/sysctl.d/custom-ip-forwarding.conf"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"/sbin/iptables"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-t"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"nat"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-A"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"POSTROUTING"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-o"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"enX0"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-j"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"MASQUERADE"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"/sbin/iptables"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-F"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"FORWARD"})]}),"\n",(0,t.jsxs)(s.span,{className:"line",children:[(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"service"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"iptables"}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"save"})]})]})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"IMPORTANT"}),": If in the step ",(0,t.jsx)(s.a,{href:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-an-eni",children:"5. Create an ENI"}),", you used a different value for the ",(0,t.jsx)(s.strong,{children:"Name"})," tag, replace ",(0,t.jsx)(s.code,{children:"nat-eni"})," with the value you used in line ",(0,t.jsx)(s.strong,{children:"9"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.ol,{start:"12",children:["\n",(0,t.jsxs)(s.li,{children:["Choose ",(0,t.jsx)(s.strong,{children:"Create launch template"}),"."]}),"\n"]})]})}let u={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,o.a)(),e.components);return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-launch-template.mdx",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-launch-template",timestamp:1723654418e3,pageMap:[{kind:"Meta",data:{index:"Introduction",overview:"Overview","before-you-start":"Before You Start",workshops:"Workshops",contact:{title:"Contact ↗",type:"page",href:"https://www.linkedin.com/in/nghia-pham-70a0ab205/",newWindow:!0}}},{kind:"MdxPage",name:"before-you-start",route:"/before-you-start"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"overview",route:"/overview"},{kind:"Folder",name:"workshops",route:"/workshops",children:[{kind:"Meta",data:{"eni-and-use-cases":"Elastic Network Interfaces (ENIs) and Use Cases"}},{kind:"Folder",name:"eni-and-use-cases",route:"/workshops/eni-and-use-cases",children:[{kind:"Meta",data:{"setup-a-low-budget-nat-instance":"Setup a Low-Budget NAT Instance","setup-a-low-budget-load-balancer":{display:"hidden",title:"Setup a Low Budget Load Balancer"}}},{kind:"MdxPage",name:"setup-a-low-budget-load-balancer",route:"/workshops/eni-and-use-cases/setup-a-low-budget-load-balancer"},{kind:"Folder",name:"setup-a-low-budget-nat-instance",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance",children:[{kind:"Meta",data:{"create-a-vpc":"1. Create a VPC","create-private-security-group":"2. Create the Security Group for the Private Instances","create-nat-security-group":"3. Create the Security Group for the NAT Instance","create-nat-role":"4. Create IAM Role for the NAT Instance","create-an-eni":"5. Create an ENI","update-private-route-tables":"6. Update Private Route Tables","create-nat-launch-template":"7. Create Launch Template for the NAT Instance","launch-nat-instance-with-asg":"8. Launch NAT Instance with Auto Scaling Group","test-nat-instance":"9. Test the NAT Instance","clean-up":"10. Clean Up",conclusion:"11. Conclusion"}},{kind:"MdxPage",name:"clean-up",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/clean-up"},{kind:"MdxPage",name:"conclusion",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/conclusion"},{kind:"MdxPage",name:"create-a-vpc",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-a-vpc"},{kind:"MdxPage",name:"create-an-eni",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-an-eni"},{kind:"MdxPage",name:"create-nat-launch-template",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-launch-template"},{kind:"MdxPage",name:"create-nat-role",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-role"},{kind:"MdxPage",name:"create-nat-security-group",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-security-group"},{kind:"MdxPage",name:"create-private-security-group",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-private-security-group"},{kind:"MdxPage",name:"launch-nat-instance-with-asg",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/launch-nat-instance-with-asg"},{kind:"MdxPage",name:"test-nat-instance",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/test-nat-instance"},{kind:"MdxPage",name:"update-private-route-tables",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/update-private-route-tables"}]},{kind:"MdxPage",name:"setup-a-low-budget-nat-instance",route:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance"}]},{kind:"MdxPage",name:"eni-and-use-cases",route:"/workshops/eni-and-use-cases"}]},{kind:"MdxPage",name:"workshops",route:"/workshops"}],flexsearch:{codeblocks:!0},title:"Create Launch Template for the NAT Instance",headings:k},pageNextRoute:"/workshops/eni-and-use-cases/setup-a-low-budget-nat-instance/create-nat-launch-template",nextraLayout:i.ZP,themeConfig:a.Z};var g=(0,r.j)(u)},8426:function(e,s,n){"use strict";var t=n(5893);n(7294);var r=n(5675),i=n.n(r);let a={head:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,t.jsx)("meta",{property:"og:title",content:"Benlab"}),(0,t.jsx)("meta",{property:"og:description",content:"Let's learn together"}),(0,t.jsx)("link",{rel:"icon",type:"image/png",href:"/images/logo.png"})]}),logo:(0,t.jsxs)("span",{children:[(0,t.jsx)(i(),{className:"rounded-full",src:"/images/logo.png",alt:"logo",height:50,width:50,style:{borderRadius:"50%",display:"inline-block"}})," ",(0,t.jsx)("b",{children:"BENLAB'S WORKSHOPS"})]}),project:{link:"https://github.com/phamtrongngh/aws-workshops"},docsRepositoryBase:"https://github.com/phamtrongngh/aws-workshops",footer:{text:""},editLink:{component:null},feedback:{content:"Give feedback"},useNextSeoProps:()=>({titleTemplate:"%s - Benlab's Workshops"})};s.Z=a},5789:function(){}},function(e){e.O(0,[774,543,888,179],function(){return e(e.s=7237)}),_N_E=e.O()}]);